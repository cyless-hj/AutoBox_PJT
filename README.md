# AutoBox : 차량 번호판을 인식을 통한 사후 처리 지원 시스템
팀장 : 정현진
팀원 : 김민종, 이승환

## 1. 프로젝트 개요

### 1-1. 주제 선정 배경
<p align="center">
<img src = "https://user-images.githubusercontent.com/75618206/203540321-e6ea8923-ccda-433e-8485-564e5ff5e56e.png">
<img src = "https://user-images.githubusercontent.com/75618206/203540345-11a7e2cf-16db-4874-b9c5-139b05b935a6.png">
</p>

- 우리나라는 경찰의 집중 단속과 블랙박스, CCTV 등의 장비 대중화로 90년대 초 40 ~ 50%의 검거율에서 평균 90% 이상으로 획기적으로 상승하였다. 하지만 미비한 사후대처에 의한 미해결 사고가 매년 발생하고 있다.
- 또한 미국에서는 2015년 737,100건의 뺑소니 사고가 발생했으며, 2016년에는 2,049명의 사망자가 발생해 최고치를 기록했다.
- 영국의 경우 세계에서 3번째로 CCTV가 많으나 전체 뺑소니 사고의 90% 이상이 미해결 사건으로 분류되고 있다. 이는 증거 부족과 인력 부족의 문제로 야기된다. 영국의 주요 도시들은 보통 매달 300 ~ 400건의 뺑소니를 처리해야 하지만, 통상적으로 4 ~ 5명의 조사관만이 이를 처리한다. 경찰 수사관 1명이 매달 100건 안팎, 하루에 5건 안팎의 사건을 해결해야 하는 셈이다.
- 본 프로젝트는 미해결 뺑소니 사건에 대한 증거 수집을 도와줄 수 있는 시스템을 제안하게 되었다. 이러한 현실에서 위 주제가 증거 수집에 도움을 주어 미해결 사건 해소에 도움을 줄 수 있으리라 생각한다.

### 1-2. 프로젝트 주제
- 차량 번호판을 인식을 통한 사후 처리 지원 시스템

## 2. 차량 사고 감지 및 관리 시스템의 설계
### 2-1. 시스템 구성도
<p align="center">
<img src = "https://user-images.githubusercontent.com/75618206/203542277-92af5096-ed07-4077-9329-0fe0a76ed110.png">
</p>

- 센서부에서는 차량의 사고를 감지하도록 한다. 
  - 본 시스템에서는 사고 감지를 위해 충격 센서와 가속도 센서를 활용하도록 한다.
  - 충격 센서는 라즈베리파이 모듈에 연결하여 데이터를 수집하고, 수집한 데이터를 모바일 기기로 전송하도록 하며 가속도 센서는 모바일 기기에 탑재되어 있는 것을 활용하여 데이터를 수집, 가공하도록 한다.
- 모바일 기기는 사고와 관련한 다양한 데이터를 수집하고 가공하기 위한 용도로 활용되며 본 시스템에서는 스마트폰을 활용하도록 한다.
  - 스마트폰에 탑재된 카메라를 활용하여 가해 차량의 번호판 이미지를 수집하고 내부 처리 과정을 거쳐 텍스트를 추출하도록 한다.
  - 또한 스마트폰의 위치 인식 기능을 활용하여 사고위치를 추출하도록 한다.
  - 모바일 기기에서 수집한 사고 관련 정보는 모바일 기기 Storage에 저장하여 관리되도록 한다.

### 2-2. 동작 플로우 차트
<p align="center">
<img src = "https://user-images.githubusercontent.com/75618206/203544518-05f12ef3-58f6-485e-96ea-d8a772b9d3f2.png">
</p>

1. 앱을 실행하면 라즈베리파이의 충격 센서와 모바일 디바이스의 가속도 센서 그리고 카메라가 활성화되며 사고를 감지하고 영상을 촬영합니다.
2. 만약 센서 값이 일정 수치 이상이 되면 사고가 발생했다고 판단하고 storage에 사고의 영상을 저장합니다.
3. 모바일 디바이스에서 사고 시점에 감지된 번호판의 텍스트를 추출하고 storage에 저장합니다.
4. 또한 사고 시점의 날짜/시간과 GPS정보를 수집하여 storage에 저장합니다.
5. 그리고 이렇게 저장된 사고 시점 영상, 차 번호 데이터, 사고 시각, 사고 위치정보 등을 앱을 통해 보여줍니다.

## 3. 구현
### 3-1. 사고 감지를 위한 센서부
- 차량 사고를 인식하는 위해 사고 인식 센서가 필요하다.
- 본 프로젝트에서는 이를 위해 라즈베리파이에 충격 센서를 연동하고 스마트폰의 가속도센서를 활용하였다.
- Mobile Device Sensor를 활용하였다.
- 충격 센서의경우충격 발생 시 아날로그 신호를 발생시키고 그 신호의 세기에 따라일정값으로 출력된다.
- 이 때 측정된 값이 설정한 값 이상이면 사고로 판단하도록 하였다.
- 스마트폰에는 가속도 센서가 탑재되어있어 이를 활용하여3차원 공간상의 변화를 측정하도록 하여 이를 수치화한 결과를 확인할수있도록 하였다.

<p align="center">
<img src = "https://user-images.githubusercontent.com/75618206/203544075-909331fe-a1b2-4cb3-9872-1777432c2638.png">
<img src = "https://user-images.githubusercontent.com/75618206/203544081-acb3a9d4-3633-4d9b-905b-6c6826109213.png">
</p>

### 3-2. 차량 번호판 인식을 위한 객체 탐지(Object Detection)
<p align="center">
<img src = "https://user-images.githubusercontent.com/75618206/203547490-ad876a95-df26-4b54-a234-6f6be5593ed1.png">
</p>

- 가해 차량의 정보를 수집, 관리하기 위하여 차량의 번호판을 탐지하여 텍스트로 추출하여 저장하도록 하였다.
- 이를 위해 먼저 차량 번호판 탐지 모듈을 구현하였다. 
- 번호판 탐지를 위해 TensorflowLite를 활용하였으며 학습데이터 구축을 위해 1,500장의 번호판 이미지를 직접 라벨링하였다.
- Tensorflow는 기계학습을 위한 오픈소스 라이브러리로 제안하는 시스템은 모바일 앱에서 구동시키므로 모바일 버전인 TensorflowLite를 활용하였다.
- 이미지 학습 : SSD MobileNet
  - 작은 물체 Detecting에 용이
  - Faster RCNN보다 빨라 해당 모델 선택
- 이미지 라벨링을 통해 학습 데이터 생성
  - 이미지 데이터 출처 : https://aihub.or.kr/aidata/27727 (차량 번호판 데이터 셋)

### 3-3. 차량 번호판 텍스트 추출
- 객체 탐지를 통해 인식된 차량 번호판에서 해당 텍스트를 추출하기 위해 Tesseract를 사용하였다.

<p align="center">
<img src = "https://user-images.githubusercontent.com/75618206/203548566-85b65798-9670-4f7e-8e83-50e86a361eb0.png">
</p>

- OpenCV Tesseract를 이용한 번호판 이미지의 텍스트 추출
- Tesseract
  - 이미지로부터 텍스트를 인식하고, 추출하는 기능을 OCR(Optical Character Recognition)이라고 한다.
  - Tesseract는 오프라인 문자인식 기법으로 입력된 이미지의 특징점을 추출하고 그 특징점을 사용하여 이미지에서 텍스트를 인식하고 추출하는 오픈소스 OCR 엔진이다
    - 입력된 이미지에서 추출한 특징점을 사용하여 문자를 인식.
    - 이후 특징점과 원본 이미지와의 오차율이 가장 낮은 문자를 선택하는 원리
  - 번호판에 정해진 한글과 숫자를 학습시켜 추출
  - 정확도를 높이기 위해 번호판 범위를 좁히고자 네모 모양의 부분을 인식하도록 조정
